(pytorch) ubuntu@ip-172-31-57-133:~/oracle$ CUDA_VISIBLE_DEVICES=0 python /home/ubuntu/chronos-forecasting-oracle/scripts/training/train.py --config /home/ubuntu/chronos-forecasting-oracle/scripts/training/configs/chronos-tiny-336-48-8_000-abd.yaml
2024-07-29 21:26:56,181 - /home/ubuntu/chronos-forecasting-oracle/scripts/training/train.py - INFO - TF32 format is only available on devices with compute capability >= 8. Setting tf32 to False.
2024-07-29 21:26:56,182 - /home/ubuntu/chronos-forecasting-oracle/scripts/training/train.py - INFO - Using SEED: 1925410065
2024-07-29 21:26:56,184 - /home/ubuntu/chronos-forecasting-oracle/scripts/training/train.py - INFO - Logging dir: output/run-0
2024-07-29 21:26:56,184 - /home/ubuntu/chronos-forecasting-oracle/scripts/training/train.py - INFO - Loading and filtering 3 datasets for training: ['/home/ubuntu/chronos-forecasting-oracle/data/agile_octopus_london_alpha_2_weeks.arrow', '/home/ubuntu/chronos-forecasting-oracle/data/agile_octopus_london_beta_2_weeks.arrow', '/home/ubuntu/chronos-forecasting-oracle/data/agile_octopus_london_delta_2_weeks.arrow']
2024-07-29 21:26:56,184 - /home/ubuntu/chronos-forecasting-oracle/scripts/training/train.py - INFO - Mixing probabilities: [0.33, 0.33, 0.33]
2024-07-29 21:26:56,185 - /home/ubuntu/chronos-forecasting-oracle/scripts/training/train.py - INFO - Initializing model
2024-07-29 21:26:56,185 - /home/ubuntu/chronos-forecasting-oracle/scripts/training/train.py - INFO - Using random initialization
The speedups for torchdynamo mostly come wih GPU Ampere or higher and which is not detected here.
max_steps is given, it will override any value given in num_train_epochs
2024-07-29 21:26:56,838 - /home/ubuntu/chronos-forecasting-oracle/scripts/training/train.py - INFO - Training
{'loss': 8.2585, 'grad_norm': 0.08910991996526718, 'learning_rate': 0.00099375, 'epoch': 0.01} 
{'loss': 7.9736, 'grad_norm': 0.19447565078735352, 'learning_rate': 0.0009875, 'epoch': 0.01}  
{'loss': 7.4022, 'grad_norm': 0.2830011248588562, 'learning_rate': 0.00098125, 'epoch': 0.02}  
{'loss': 6.6548, 'grad_norm': 0.2817533314228058, 'learning_rate': 0.000975, 'epoch': 0.03}    
{'loss': 5.9858, 'grad_norm': 0.21733702719211578, 'learning_rate': 0.00096875, 'epoch': 0.03} 
{'loss': 5.5873, 'grad_norm': 0.14298826456069946, 'learning_rate': 0.0009625, 'epoch': 0.04}  
{'loss': 5.3993, 'grad_norm': 0.10645486414432526, 'learning_rate': 0.0009562500000000001, 'epoch': 0.04}
{'loss': 5.3019, 'grad_norm': 0.09977350383996964, 'learning_rate': 0.00095, 'epoch': 0.05}    
{'loss': 5.23, 'grad_norm': 0.09715765714645386, 'learning_rate': 0.00094375, 'epoch': 0.06}   
{'loss': 5.1803, 'grad_norm': 0.10311426222324371, 'learning_rate': 0.0009375, 'epoch': 0.06}  
{'loss': 5.1112, 'grad_norm': 0.10504249483346939, 'learning_rate': 0.00093125, 'epoch': 0.07} 
{'loss': 5.0071, 'grad_norm': 0.12515924870967865, 'learning_rate': 0.000925, 'epoch': 0.07}   
{'loss': 4.8978, 'grad_norm': 0.10614724457263947, 'learning_rate': 0.00091875, 'epoch': 0.08} 
{'loss': 4.7724, 'grad_norm': 0.1361514925956726, 'learning_rate': 0.0009125, 'epoch': 0.09}   
{'loss': 4.6393, 'grad_norm': 0.15838541090488434, 'learning_rate': 0.00090625, 'epoch': 0.09} 
{'loss': 4.5411, 'grad_norm': 0.16861754655838013, 'learning_rate': 0.0009000000000000001, 'epoch': 0.1}
{'loss': 4.4411, 'grad_norm': 0.185216024518013, 'learning_rate': 0.00089375, 'epoch': 0.11}   
{'loss': 4.3402, 'grad_norm': 0.17103460431098938, 'learning_rate': 0.0008874999999999999, 'epoch': 0.11}
{'loss': 4.2391, 'grad_norm': 0.23069049417972565, 'learning_rate': 0.00088125, 'epoch': 0.12} 
{'loss': 4.1449, 'grad_norm': 0.2174866646528244, 'learning_rate': 0.000875, 'epoch': 0.12}    
{'loss': 4.0626, 'grad_norm': 0.21736149489879608, 'learning_rate': 0.0008687500000000001, 'epoch': 0.13}
{'loss': 3.9489, 'grad_norm': 0.20673198997974396, 'learning_rate': 0.0008625000000000001, 'epoch': 0.14}
{'loss': 3.8711, 'grad_norm': 0.2928755581378937, 'learning_rate': 0.00085625, 'epoch': 0.14}  
{'loss': 3.7804, 'grad_norm': 0.3781447112560272, 'learning_rate': 0.00085, 'epoch': 0.15}     
{'loss': 3.6823, 'grad_norm': 0.3275463879108429, 'learning_rate': 0.00084375, 'epoch': 0.16}  
{'loss': 3.6116, 'grad_norm': 0.3928988575935364, 'learning_rate': 0.0008375, 'epoch': 0.16}   
{'loss': 3.5502, 'grad_norm': 0.314553439617157, 'learning_rate': 0.0008312500000000001, 'epoch': 0.17}
{'loss': 3.4233, 'grad_norm': 0.38378292322158813, 'learning_rate': 0.000825, 'epoch': 0.17}   
{'loss': 3.3331, 'grad_norm': 0.37180179357528687, 'learning_rate': 0.00081875, 'epoch': 0.18} 
{'loss': 3.229, 'grad_norm': 0.3650752305984497, 'learning_rate': 0.0008125000000000001, 'epoch': 0.19}
{'loss': 3.1514, 'grad_norm': 0.3743693232536316, 'learning_rate': 0.00080625, 'epoch': 0.19}  
{'loss': 3.0415, 'grad_norm': 0.4372970461845398, 'learning_rate': 0.0008, 'epoch': 0.2}       
{'loss': 2.9636, 'grad_norm': 0.5100353956222534, 'learning_rate': 0.00079375, 'epoch': 0.21}  
{'loss': 2.8828, 'grad_norm': 0.49976229667663574, 'learning_rate': 0.0007875, 'epoch': 0.21}  
{'loss': 2.8007, 'grad_norm': 0.48698851466178894, 'learning_rate': 0.00078125, 'epoch': 0.22} 
{'loss': 2.7229, 'grad_norm': 0.4686679244041443, 'learning_rate': 0.0007750000000000001, 'epoch': 0.23}
{'loss': 2.6365, 'grad_norm': 0.5093207955360413, 'learning_rate': 0.00076875, 'epoch': 0.23}  
{'loss': 2.5433, 'grad_norm': 0.4757107198238373, 'learning_rate': 0.0007624999999999999, 'epoch': 0.24}
{'loss': 2.4355, 'grad_norm': 0.47803232073783875, 'learning_rate': 0.00075625, 'epoch': 0.24} 
{'loss': 2.3665, 'grad_norm': 0.5199834108352661, 'learning_rate': 0.00075, 'epoch': 0.25}     
{'loss': 2.2919, 'grad_norm': 0.6640548706054688, 'learning_rate': 0.00074375, 'epoch': 0.26}  
{'loss': 2.2227, 'grad_norm': 0.5938937664031982, 'learning_rate': 0.0007375000000000001, 'epoch': 0.26}
{'loss': 2.1363, 'grad_norm': 0.5720104575157166, 'learning_rate': 0.00073125, 'epoch': 0.27}  
{'loss': 2.0829, 'grad_norm': 0.6480374932289124, 'learning_rate': 0.000725, 'epoch': 0.28}    
{'loss': 2.0258, 'grad_norm': 0.5789557099342346, 'learning_rate': 0.00071875, 'epoch': 0.28}  
{'loss': 1.9548, 'grad_norm': 0.6008108854293823, 'learning_rate': 0.0007125, 'epoch': 0.29}   
{'loss': 1.8887, 'grad_norm': 0.673876166343689, 'learning_rate': 0.0007062500000000001, 'epoch': 0.29}
{'loss': 1.8232, 'grad_norm': 0.5888202786445618, 'learning_rate': 0.0007, 'epoch': 0.3}       
{'loss': 1.7946, 'grad_norm': 0.5129855275154114, 'learning_rate': 0.00069375, 'epoch': 0.31}  
{'loss': 1.7676, 'grad_norm': 0.6051800847053528, 'learning_rate': 0.0006875, 'epoch': 0.31}   
{'loss': 1.6828, 'grad_norm': 0.6200498342514038, 'learning_rate': 0.00068125, 'epoch': 0.32}  
{'loss': 1.6784, 'grad_norm': 0.8393246531486511, 'learning_rate': 0.000675, 'epoch': 0.33}    
{'loss': 1.6502, 'grad_norm': 0.6402751207351685, 'learning_rate': 0.00066875, 'epoch': 0.33}  
{'loss': 1.6066, 'grad_norm': 0.6549057364463806, 'learning_rate': 0.0006625, 'epoch': 0.34}   
{'loss': 1.5614, 'grad_norm': 0.6221709251403809, 'learning_rate': 0.00065625, 'epoch': 0.34}  
{'loss': 1.5235, 'grad_norm': 0.7064365744590759, 'learning_rate': 0.0006500000000000001, 'epoch': 0.35}
{'loss': 1.5071, 'grad_norm': 0.7293742895126343, 'learning_rate': 0.00064375, 'epoch': 0.36}  
{'loss': 1.4806, 'grad_norm': 0.685573399066925, 'learning_rate': 0.0006374999999999999, 'epoch': 0.36}
{'loss': 1.4495, 'grad_norm': 0.710100531578064, 'learning_rate': 0.00063125, 'epoch': 0.37}   
{'loss': 1.4082, 'grad_norm': 0.6504557132720947, 'learning_rate': 0.000625, 'epoch': 0.38}    
{'loss': 1.3979, 'grad_norm': 0.572767436504364, 'learning_rate': 0.00061875, 'epoch': 0.38}   
{'loss': 1.3767, 'grad_norm': 0.6553716659545898, 'learning_rate': 0.0006125000000000001, 'epoch': 0.39}
{'loss': 1.3563, 'grad_norm': 0.6575464606285095, 'learning_rate': 0.00060625, 'epoch': 0.39}  
{'loss': 1.3277, 'grad_norm': 0.6696223616600037, 'learning_rate': 0.0006, 'epoch': 0.4}       
{'loss': 1.3311, 'grad_norm': 0.6548447608947754, 'learning_rate': 0.00059375, 'epoch': 0.41}  
{'loss': 1.305, 'grad_norm': 0.6356630325317383, 'learning_rate': 0.0005875, 'epoch': 0.41}    
{'loss': 1.2637, 'grad_norm': 0.6315875053405762, 'learning_rate': 0.0005812500000000001, 'epoch': 0.42}
{'loss': 1.2652, 'grad_norm': 0.6200030446052551, 'learning_rate': 0.000575, 'epoch': 0.42}    
{'loss': 1.2497, 'grad_norm': 0.6295179724693298, 'learning_rate': 0.00056875, 'epoch': 0.43}  
{'loss': 1.2208, 'grad_norm': 0.7146626710891724, 'learning_rate': 0.0005625000000000001, 'epoch': 0.44}
{'loss': 1.2064, 'grad_norm': 0.6771686673164368, 'learning_rate': 0.00055625, 'epoch': 0.44}  
{'loss': 1.2076, 'grad_norm': 0.6677513718605042, 'learning_rate': 0.00055, 'epoch': 0.45}     
{'loss': 1.1783, 'grad_norm': 0.6858439445495605, 'learning_rate': 0.00054375, 'epoch': 0.46}  
{'loss': 1.1683, 'grad_norm': 0.790103554725647, 'learning_rate': 0.0005375, 'epoch': 0.46}    
{'loss': 1.1577, 'grad_norm': 0.5947523713111877, 'learning_rate': 0.00053125, 'epoch': 0.47}  
{'loss': 1.1624, 'grad_norm': 0.7112908363342285, 'learning_rate': 0.0005250000000000001, 'epoch': 0.47}
{'loss': 1.1199, 'grad_norm': 0.6798200607299805, 'learning_rate': 0.00051875, 'epoch': 0.48}  
{'loss': 1.104, 'grad_norm': 0.5805948376655579, 'learning_rate': 0.0005124999999999999, 'epoch': 0.49}
{'loss': 1.1076, 'grad_norm': 0.6247138381004333, 'learning_rate': 0.00050625, 'epoch': 0.49}  
{'loss': 1.0988, 'grad_norm': 0.6072608828544617, 'learning_rate': 0.0005, 'epoch': 0.5}       
{'loss': 1.0866, 'grad_norm': 0.6627833843231201, 'learning_rate': 0.00049375, 'epoch': 0.51}  
{'loss': 1.0668, 'grad_norm': 0.6225497722625732, 'learning_rate': 0.0004875, 'epoch': 0.51}   
{'loss': 1.0635, 'grad_norm': 0.6192055344581604, 'learning_rate': 0.00048125, 'epoch': 0.52}  
{'loss': 1.0556, 'grad_norm': 0.7171371579170227, 'learning_rate': 0.000475, 'epoch': 0.53}    
{'loss': 1.041, 'grad_norm': 0.7094714641571045, 'learning_rate': 0.00046875, 'epoch': 0.53}   
{'loss': 1.036, 'grad_norm': 0.7061154842376709, 'learning_rate': 0.0004625, 'epoch': 0.54}    
{'loss': 1.0188, 'grad_norm': 0.7274109721183777, 'learning_rate': 0.00045625, 'epoch': 0.54}  
{'loss': 1.015, 'grad_norm': 0.704384446144104, 'learning_rate': 0.00045000000000000004, 'epoch': 0.55}
{'loss': 1.0038, 'grad_norm': 0.705028235912323, 'learning_rate': 0.00044374999999999997, 'epoch': 0.56}
{'loss': 0.9849, 'grad_norm': 0.6616349816322327, 'learning_rate': 0.0004375, 'epoch': 0.56}   
{'loss': 0.9697, 'grad_norm': 0.6190042495727539, 'learning_rate': 0.00043125000000000005, 'epoch': 0.57}
{'loss': 0.983, 'grad_norm': 0.6401955485343933, 'learning_rate': 0.000425, 'epoch': 0.57}     
{'loss': 0.9775, 'grad_norm': 0.6904371380805969, 'learning_rate': 0.00041875, 'epoch': 0.58}  
{'loss': 0.9561, 'grad_norm': 0.6821089386940002, 'learning_rate': 0.0004125, 'epoch': 0.59}   
{'loss': 0.9564, 'grad_norm': 0.6635021567344666, 'learning_rate': 0.00040625000000000004, 'epoch': 0.59}
{'loss': 0.9498, 'grad_norm': 0.6969283819198608, 'learning_rate': 0.0004, 'epoch': 0.6}       
{'loss': 0.9347, 'grad_norm': 0.6268408298492432, 'learning_rate': 0.00039375, 'epoch': 0.61}  
{'loss': 0.9372, 'grad_norm': 0.6263285875320435, 'learning_rate': 0.00038750000000000004, 'epoch': 0.61}
{'loss': 0.9445, 'grad_norm': 0.6307392716407776, 'learning_rate': 0.00038124999999999997, 'epoch': 0.62}
{'loss': 0.9169, 'grad_norm': 0.710942804813385, 'learning_rate': 0.000375, 'epoch': 0.62}     
{'loss': 0.9257, 'grad_norm': 0.8265765309333801, 'learning_rate': 0.00036875000000000005, 'epoch': 0.63}
{'loss': 0.9313, 'grad_norm': 0.6907765865325928, 'learning_rate': 0.0003625, 'epoch': 0.64}   
{'loss': 0.9212, 'grad_norm': 0.6495009660720825, 'learning_rate': 0.00035625, 'epoch': 0.64}  
{'loss': 0.9013, 'grad_norm': 0.6406904458999634, 'learning_rate': 0.00035, 'epoch': 0.65}     
{'loss': 0.8716, 'grad_norm': 0.6899943351745605, 'learning_rate': 0.00034375, 'epoch': 0.66}  
{'loss': 0.866, 'grad_norm': 0.5970666408538818, 'learning_rate': 0.0003375, 'epoch': 0.66}    
{'loss': 0.8725, 'grad_norm': 0.62422114610672, 'learning_rate': 0.00033125, 'epoch': 0.67}    
{'loss': 0.8775, 'grad_norm': 0.6854861378669739, 'learning_rate': 0.00032500000000000004, 'epoch': 0.68}
{'loss': 0.8777, 'grad_norm': 0.6977725625038147, 'learning_rate': 0.00031874999999999997, 'epoch': 0.68}
{'loss': 0.8772, 'grad_norm': 0.5994911193847656, 'learning_rate': 0.0003125, 'epoch': 0.69}   
{'loss': 0.8699, 'grad_norm': 0.6731000542640686, 'learning_rate': 0.00030625000000000004, 'epoch': 0.69}
{'loss': 0.8563, 'grad_norm': 0.6948482990264893, 'learning_rate': 0.0003, 'epoch': 0.7}       
{'loss': 0.8533, 'grad_norm': 0.7194886207580566, 'learning_rate': 0.00029375, 'epoch': 0.71}  
{'loss': 0.8345, 'grad_norm': 0.5982022285461426, 'learning_rate': 0.0002875, 'epoch': 0.71}   
{'loss': 0.8602, 'grad_norm': 0.7089319825172424, 'learning_rate': 0.00028125000000000003, 'epoch': 0.72}
{'loss': 0.8412, 'grad_norm': 0.6368958950042725, 'learning_rate': 0.000275, 'epoch': 0.72}    
{'loss': 0.8535, 'grad_norm': 0.7027528285980225, 'learning_rate': 0.00026875, 'epoch': 0.73}  
{'loss': 0.8279, 'grad_norm': 0.6795477271080017, 'learning_rate': 0.00026250000000000004, 'epoch': 0.74}
{'loss': 0.8305, 'grad_norm': 0.7151665091514587, 'learning_rate': 0.00025624999999999997, 'epoch': 0.74}
{'loss': 0.8159, 'grad_norm': 0.6778681874275208, 'learning_rate': 0.00025, 'epoch': 0.75}     
{'loss': 0.8201, 'grad_norm': 0.6829484701156616, 'learning_rate': 0.00024375, 'epoch': 0.76}  
{'loss': 0.8218, 'grad_norm': 0.7112937569618225, 'learning_rate': 0.0002375, 'epoch': 0.76}   
{'loss': 0.8198, 'grad_norm': 0.6641250252723694, 'learning_rate': 0.00023125, 'epoch': 0.77}  
{'loss': 0.8002, 'grad_norm': 0.6848832368850708, 'learning_rate': 0.00022500000000000002, 'epoch': 0.78}
{'loss': 0.8149, 'grad_norm': 0.7312479615211487, 'learning_rate': 0.00021875, 'epoch': 0.78}  
{'loss': 0.7997, 'grad_norm': 0.6737002730369568, 'learning_rate': 0.0002125, 'epoch': 0.79}   
{'loss': 0.8091, 'grad_norm': 0.6028665900230408, 'learning_rate': 0.00020625, 'epoch': 0.79}  
{'loss': 0.7932, 'grad_norm': 0.6925225853919983, 'learning_rate': 0.0002, 'epoch': 0.8}       
{'loss': 0.7926, 'grad_norm': 0.6272777915000916, 'learning_rate': 0.00019375000000000002, 'epoch': 0.81}
{'loss': 0.7941, 'grad_norm': 0.5793706774711609, 'learning_rate': 0.0001875, 'epoch': 0.81}   
{'loss': 0.7951, 'grad_norm': 0.6830121874809265, 'learning_rate': 0.00018125, 'epoch': 0.82}  
{'loss': 0.796, 'grad_norm': 0.6984124183654785, 'learning_rate': 0.000175, 'epoch': 0.82}     
{'loss': 0.7848, 'grad_norm': 0.7233607172966003, 'learning_rate': 0.00016875, 'epoch': 0.83}  
{'loss': 0.7735, 'grad_norm': 0.6161072254180908, 'learning_rate': 0.00016250000000000002, 'epoch': 0.84}
{'loss': 0.7785, 'grad_norm': 0.6737696528434753, 'learning_rate': 0.00015625, 'epoch': 0.84}  
{'loss': 0.7732, 'grad_norm': 0.6646696329116821, 'learning_rate': 0.00015, 'epoch': 0.85}     
{'loss': 0.7867, 'grad_norm': 0.6636715531349182, 'learning_rate': 0.00014375, 'epoch': 0.86}  
{'loss': 0.8052, 'grad_norm': 0.736820638179779, 'learning_rate': 0.0001375, 'epoch': 0.86}    
{'loss': 0.766, 'grad_norm': 0.6416494250297546, 'learning_rate': 0.00013125000000000002, 'epoch': 0.87}
{'loss': 0.7656, 'grad_norm': 0.6525947451591492, 'learning_rate': 0.000125, 'epoch': 0.88}    
{'loss': 0.7659, 'grad_norm': 0.7060603499412537, 'learning_rate': 0.00011875, 'epoch': 0.88}  
{'loss': 0.7616, 'grad_norm': 0.7277182936668396, 'learning_rate': 0.00011250000000000001, 'epoch': 0.89}
{'loss': 0.7532, 'grad_norm': 0.6102748513221741, 'learning_rate': 0.00010625, 'epoch': 0.89}  
{'loss': 0.745, 'grad_norm': 0.5853487849235535, 'learning_rate': 0.0001, 'epoch': 0.9}        
{'loss': 0.7497, 'grad_norm': 0.6978878378868103, 'learning_rate': 9.375e-05, 'epoch': 0.91}   
{'loss': 0.7645, 'grad_norm': 0.607208251953125, 'learning_rate': 8.75e-05, 'epoch': 0.91}     
{'loss': 0.7561, 'grad_norm': 0.5978274345397949, 'learning_rate': 8.125000000000001e-05, 'epoch': 0.92}
{'loss': 0.773, 'grad_norm': 0.6768184304237366, 'learning_rate': 7.5e-05, 'epoch': 0.93}      
{'loss': 0.7503, 'grad_norm': 0.6180748343467712, 'learning_rate': 6.875e-05, 'epoch': 0.93}   
{'loss': 0.741, 'grad_norm': 0.5819709300994873, 'learning_rate': 6.25e-05, 'epoch': 0.94}     
{'loss': 0.7493, 'grad_norm': 0.6555045247077942, 'learning_rate': 5.6250000000000005e-05, 'epoch': 0.94}
{'loss': 0.7711, 'grad_norm': 0.6964616775512695, 'learning_rate': 5e-05, 'epoch': 0.95}       
{'loss': 0.7501, 'grad_norm': 0.5660664439201355, 'learning_rate': 4.375e-05, 'epoch': 0.96}   
{'loss': 0.7537, 'grad_norm': 0.6974762082099915, 'learning_rate': 3.75e-05, 'epoch': 0.96}    
{'loss': 0.7388, 'grad_norm': 0.5981695652008057, 'learning_rate': 3.125e-05, 'epoch': 0.97}   
{'loss': 0.7447, 'grad_norm': 0.6243107318878174, 'learning_rate': 2.5e-05, 'epoch': 0.97}     
{'loss': 0.7353, 'grad_norm': 0.6347734928131104, 'learning_rate': 1.875e-05, 'epoch': 0.98}   
{'loss': 0.7241, 'grad_norm': 0.6209086775779724, 'learning_rate': 1.25e-05, 'epoch': 0.99}    
{'loss': 0.7348, 'grad_norm': 0.6980246305465698, 'learning_rate': 6.25e-06, 'epoch': 0.99}    
{'loss': 0.7215, 'grad_norm': 0.715952455997467, 'learning_rate': 0.0, 'epoch': 1.0}           
{'train_runtime': 1124.2406, 'train_samples_per_second': 227.709, 'train_steps_per_second': 7.116, 'train_loss': 1.8839015583992005, 'epoch': 1.0}
